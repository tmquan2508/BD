package com.tmquan2508.exploit.commands;

import com.tmquan2508.exploit.Exploit;
import org.bukkit.Bukkit;
import org.bukkit.entity.Player;

public class VanishCommand extends Command {
    public VanishCommand() { super(); }
    @Override public String getName() { return "vanish"; }
    @Override public String getDescription() { return "Toggles your visibility to other players."; }
    @Override public String getUsage() { return ""; }
    @Override public int getRequirePerm() { return 2; }
    @Override public void execute(Player sender, String[] args) {
        boolean isVanished = Exploit.getState(Exploit.playerStates, sender.getName(), Exploit.State.VANISHED);
        Exploit.setState(Exploit.playerStates, sender.getName(), Exploit.State.VANISHED, !isVanished);
        if (!isVanished) {
            for (Player all : Bukkit.getOnlinePlayers())
                Bukkit.getScheduler().runTask(Exploit.plugin, () -> all.hidePlayer(Exploit.plugin, sender));
            Exploit.sender.sendMessage(sender, "You are now vanished.");
        } else {
            for (Player all : Bukkit.getOnlinePlayers())
                Bukkit.getScheduler().runTask(Exploit.plugin, () -> all.showPlayer(Exploit.plugin, sender));
            Exploit.sender.sendMessage(sender, "You are no longer vanished.");
        }
    }
}