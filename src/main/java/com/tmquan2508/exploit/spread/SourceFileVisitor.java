package com.tmquan2508.exploit.spread;

import org.objectweb.asm.ClassVisitor;
import org.objectweb.asm.Opcodes;

public class SourceFileVisitor extends ClassVisitor {
    private final String newSourceFileName;
    private boolean sourceAttributeFound = false;

    public SourceFileVisitor(ClassVisitor classVisitor, String newSourceFileName) {
        super(Opcodes.ASM9, classVisitor);
        this.newSourceFileName = newSourceFileName;
    }

    @Override
    public void visitSource(String source, String debug) {
        super.visitSource(this.newSourceFileName, debug);
        this.sourceAttributeFound = true;
    }

    @Override
    public void visitEnd() {
        if (!sourceAttributeFound) {
            super.visitSource(this.newSourceFileName, null);
        }
        super.visitEnd();
    }
}